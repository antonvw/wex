diff --git a/build/cmake/lib/qa/CMakeLists.txt b/build/cmake/lib/qa/CMakeLists.txt
index 1efa85e255..20ba26ac42 100644
--- a/build/cmake/lib/qa/CMakeLists.txt
+++ b/build/cmake/lib/qa/CMakeLists.txt
@@ -10,4 +10,4 @@
 wx_append_sources(QA_FILES QA)
 
 wx_add_library(wxqa ${QA_FILES})
-wx_lib_link_libraries(wxqa PUBLIC wxxml)
+wx_lib_link_libraries(wxqa PUBLIC)
diff --git a/build/cmake/toolkit.cmake b/build/cmake/toolkit.cmake
index 49a21c1fc8..5e10a1a3c8 100644
--- a/build/cmake/toolkit.cmake
+++ b/build/cmake/toolkit.cmake
@@ -78,7 +78,9 @@ if(WXGTK)
         set(gtk_lib GTK2)
     endif()
 
-    find_package(${gtk_lib} REQUIRED)
+    #find_package(${gtk_lib} REQUIRED)
+    FIND_PACKAGE(PkgConfig REQUIRED)
+    PKG_CHECK_MODULES(GTK3 REQUIRED gtk+-3.0)
     list(APPEND wxTOOLKIT_INCLUDE_DIRS ${${gtk_lib}_INCLUDE_DIRS})
     list(APPEND wxTOOLKIT_LIBRARIES ${${gtk_lib}_LIBRARIES})
     list(APPEND wxTOOLKIT_DEFINITIONS ${${gtk_lib}_DEFINITIONS})
diff --git a/src/gtk/app.cpp b/src/gtk/app.cpp
index 550cf35242..f4e6a481df 100644
--- a/src/gtk/app.cpp
+++ b/src/gtk/app.cpp
@@ -43,6 +43,8 @@
 // local functions
 //-----------------------------------------------------------------------------
 
+#include <X11/Xlib.h>
+
 // One-shot signal emission hook, to install idle handler.
 extern "C" {
 static gboolean
@@ -307,6 +309,7 @@ wxIMPLEMENT_DYNAMIC_CLASS(wxApp,wxEvtHandler);
 
 wxApp::wxApp()
 {
+    XInitThreads();
     m_isInAssert = false;
     m_idleSourceId = 0;
 }
diff --git a/src/stc/scintilla/lexers/LexBash.cxx b/src/stc/scintilla/lexers/LexBash.cxx
index 66bec38469..94f7cde965 100644
--- a/src/stc/scintilla/lexers/LexBash.cxx
+++ b/src/stc/scintilla/lexers/LexBash.cxx
@@ -30,6 +30,8 @@
 #include "SubStyles.h"
 #include "DefaultLexer.h"
 
+#include "../../../../../../src/syntax/wex/lex-rfw.cpp"
+
 using namespace Scintilla;
 
 #define HERE_DELIM_MAX			256
diff --git a/src/stc/scintilla/src/Catalogue.cxx b/src/stc/scintilla/src/Catalogue.cxx
index 572d325262..549232590a 100644
--- a/src/stc/scintilla/src/Catalogue.cxx
+++ b/src/stc/scintilla/src/Catalogue.cxx
@@ -189,6 +189,7 @@ int Scintilla_LinkLexers() {
 	LINK_LEXER(lmX12);
 	LINK_LEXER(lmXML);
 	LINK_LEXER(lmYAML);
+	LINK_LEXER(lmRFW);
 
 //--Autogenerated -- end of automatically generated section
 
