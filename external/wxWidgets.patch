diff --git a/build/cmake/lib/qa/CMakeLists.txt b/build/cmake/lib/qa/CMakeLists.txt
index 1efa85e255..20ba26ac42 100644
--- a/build/cmake/lib/qa/CMakeLists.txt
+++ b/build/cmake/lib/qa/CMakeLists.txt
@@ -10,4 +10,4 @@
 wx_append_sources(QA_FILES QA)
 
 wx_add_library(wxqa ${QA_FILES})
-wx_lib_link_libraries(wxqa PUBLIC wxxml)
+wx_lib_link_libraries(wxqa PUBLIC)
diff --git a/build/cmake/lib/stc/CMakeLists.txt b/build/cmake/lib/stc/CMakeLists.txt
index 1116186833..c3aa6272c5 100644
--- a/build/cmake/lib/stc/CMakeLists.txt
+++ b/build/cmake/lib/stc/CMakeLists.txt
@@ -163,7 +163,6 @@ target_include_directories(wxscintilla PRIVATE
     ${wxSOURCE_DIR}/src/stc/scintilla/src
     )
 target_compile_definitions(wxscintilla PRIVATE
-    NO_CXX11_REGEX
     __WX__
     SCI_LEXER
     LINK_LEXERS
@@ -177,7 +176,6 @@ wx_lib_include_directories(wxstc
     ${wxSOURCE_DIR}/src/stc/scintilla/src
     )
 wx_lib_compile_definitions(wxstc
-    NO_CXX11_REGEX
     __WX__
     SCI_LEXER
     LINK_LEXERS
diff --git a/build/cmake/toolkit.cmake b/build/cmake/toolkit.cmake
index 2b8dbbe5db..dcc588adc6 100644
--- a/build/cmake/toolkit.cmake
+++ b/build/cmake/toolkit.cmake
@@ -80,7 +80,10 @@ if(WXGTK)
         set(gtk_lib GTK2)
     endif()
 
-    find_package(${gtk_lib} REQUIRED)
+#    find_package(${gtk_lib} REQUIRED)
+    FIND_PACKAGE(PkgConfig REQUIRED)
+    PKG_CHECK_MODULES(GTK3 REQUIRED gtk+-3.0)
+
     list(APPEND wxTOOLKIT_INCLUDE_DIRS ${${gtk_lib}_INCLUDE_DIRS})
     list(APPEND wxTOOLKIT_LIBRARIES ${${gtk_lib}_LIBRARIES})
     list(APPEND wxTOOLKIT_DEFINITIONS ${${gtk_lib}_DEFINITIONS})
diff --git a/src/stc/scintilla/lexers/LexBash.cxx b/src/stc/scintilla/lexers/LexBash.cxx
index af8507d7de..4a804678bd 100644
--- a/src/stc/scintilla/lexers/LexBash.cxx
+++ b/src/stc/scintilla/lexers/LexBash.cxx
@@ -23,6 +23,8 @@
 #include "CharacterSet.h"
 #include "LexerModule.h"
 
+#include "../../../../../../src/lexers/lex-rfw.cpp"
+
 #ifdef SCI_NAMESPACE
 using namespace Scintilla;
 #endif
diff --git a/src/gtk/app.cpp b/src/gtk/app.cpp
index afae00e006..daa1d658c8 100644
--- a/src/gtk/app.cpp
+++ b/src/gtk/app.cpp
@@ -6,6 +6,7 @@
 // Licence:     wxWindows licence
 /////////////////////////////////////////////////////////////////////////////
 
+
 // For compilers that support precompilation, includes "wx.h".
 #include "wx/wxprec.h"
 
@@ -21,6 +22,8 @@
 
 #include "wx/thread.h"
 
+#include <X11/Xlib.h>
+
 #ifdef __WXGPE__
     #include <gpe/init.h>
 #endif
@@ -186,6 +189,7 @@ wxIMPLEMENT_DYNAMIC_CLASS(wxApp,wxEvtHandler);
 
 wxApp::wxApp()
 {
+    XInitThreads();
     m_isInAssert = false;
     m_idleSourceId = 0;
 }
