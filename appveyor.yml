version: 19.10.0.{build}

image: Visual Studio 2017

clone_folder: c:\projects\wex

clone_depth: 5

configuration: 
  - Release

install:
  - git config http.postBuffer 1048576000
  - git submodule init && git submodule update --init --recursive --depth 50

before_build:
  - mkdir build && cd build

build_script:
  - call "C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Auxiliary\Build\vcvars32.bat"
  - set CL=/Zc:__cplusplus
  - cmake -DBOOST_ROOT=C:\Libraries\boost_1_69_0 -DCMAKE_BUILD_TYPE=%configuration% -DwexBUILD_TESTS=ON -DENABLE_GETTEXT=ON ..
  - echo %configuration%
  - devenv wex.sln /Build %configuration%
#  - devenv wex.sln /Build Release /project RUN_TESTS
  - ..\ci\pack.bat

test: OFF

artifacts:
  - path: 'build\syncped-v19.10.0.zip'
