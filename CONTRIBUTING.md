# How to contribute

- fork the repository on GitHub

- create a feature branch from the develop branch to base your work

## Adding functionality

- use style as indicated by .clang-format

- use STL whenever possible

- doxy document sources
  API documentation is generated from the sources
  using [Doxygen](http://www.stack.nl/~dimitri/doxygen/)

- translation is done using xgettext by invoking po-sync.sh
  - to translate wex copy the wex.pot file to the correct language po
    file, and fill in the translation.

  - The place where to put your po files can be found by adding -l command-line switch.
    You can also test other languages using the special Language config item,
    e.g. setting it to french allows you to test french translation.
    Normally you check the current locale by running locale on the
    command-line. Running locale -a shows all your available locales, if your
    locale is not present, add it using locale-gen (provided it is in
    the list of all locales (/usr/share/i18n/SUPPORTED).
    Then you do export LANG=..., or change the /etc/default/locale.

  - To add translation files add -DwexENABLE_GETTEXT=ON to cmake.
  
## Analyse it

At GitHub some code analysers will do this, it is also possible to do
some local checks:

- codespell
- cppcheck
- cpplint

```bash
ci/codespell
ci/cppcheck
ci/cpplint src/*/*.cpp
```

## Test it
- add a test (and update sample)

```bash
mkdir build && cd build
cmake -DwexBUILD_TESTS=ON -DwexBUILD_SAMPLES=ON ..
make
make test
```

- test coverage can be generated by using `CMAKE_BUILD_TYPE=Coverage`
  This requires `lcov` and `genhtml` tools (part of lcov).
  It implicitly builds tests and samples, no need to specify it separately.

```bash
mkdir coverage && cd coverage
cmake -DCMAKE_BUILD_TYPE=Coverage ..
make
make lcov-prep
make test
make lcov
```

- asan Leak Sanitizer can be used by adding -DwexENABLE_ASAN=ON to cmake

```bash
cmake -DwexENABLE_ASAN=ON -DwexBUILD_TESTS=ON ..
make
export ASAN_OPTIONS=detect_leaks=1,detect_container_overflow=0
./test/core/wex-test-core
```

- Do a pull request from the feature branch to the develop branch

## Boost build

- if you want to use another boost version from current one on your system:

```bash
wget https://dl.bintray.com/boostorg/release/<>/source/boost_<>.tar.gz
tar -xzf boost_<>*
cd boost_<>*
./bootstrap.sh --prefix=<path>
./b2
sudo ./b2 install --prefix=<path> --with=all
cmake -DBOOST_ROOT=<path>
```
