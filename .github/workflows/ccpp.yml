name: github-ci
on: [push]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        with:
          submodules: recursive

      - name: Install boost and gtk3
        run: sudo apt-get update && sudo apt-get install -yq libboost-all-dev liblzma5 libjbig0 libgtk-3-dev

      - name: Install gcc
        run: sudo apt-get install -yq gcc-12 g++-12

      - name: Configure
        run: export CC=gcc-12 && export CXX=g++-12 && mkdir build && cd build && cmake ..

      - name: Make
        run: cd build && make

      - name: Test
        run: cd build && ctest -VV
